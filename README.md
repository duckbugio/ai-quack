# Утка - Flappy Bird Clone

Веб-игра в стиле Flappy Bird, разработанная на React и TypeScript. Управляйте уткой, избегайте препятствий и набирайте очки!

## Описание

"Утка" - это современная веб-игра, клон популярной игры Flappy Bird. Игрок управляет уткой, которая должна пролетать между препятствиями, набирая очки за каждое успешно пройденное препятствие. Игра становится сложнее с увеличением счета благодаря прогрессивной системе сложности.

## Технологии

- **React 18+** - UI библиотека для создания компонентов
- **TypeScript 5+** - Типизированный JavaScript для надежности кода
- **Vite** - Современный сборщик для быстрой разработки
- **Canvas API** - Рендеринг игровой графики и анимаций
- **CSS Modules** - Стилизация компонентов
- **Vitest** - Фреймворк для тестирования

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd duck-game
```

2. Установите зависимости:
```bash
npm install
```

## Запуск

### Режим разработки

Запустите dev-сервер:
```bash
npm run dev
```

Приложение будет доступно по адресу `http://localhost:5173` (или другому порту, указанному Vite).

### Production сборка

Создайте production сборку:
```bash
npm run build
```

Собранные файлы будут находиться в директории `dist/`.

### Предпросмотр production сборки

Для предпросмотра production сборки:
```bash
npm run preview
```

## Управление

- **Пробел** или **Стрелка вверх** - прыжок утки
- **Клик мыши** или **Тап** - прыжок утки
- **Escape** - пауза (во время игры)

## Игровые механики

- **Гравитация** - утка постоянно падает вниз под действием гравитации
- **Прыжок** - нажатие клавиши или клик заставляет утку подпрыгнуть вверх
- **Препятствия** - случайно генерируемые препятствия с проходами между ними
- **Подсчет очков** - очко начисляется за каждое успешно пройденное препятствие
- **Прогрессивная сложность** - скорость препятствий и расстояние между ними изменяются с увеличением счета
- **Система частиц** - визуальные эффекты при столкновении
- **Звуковые эффекты** - звуки прыжка, столкновения и набора очков

## Архитектура проекта

```
src/
├── components/          # React компоненты
│   ├── Game/          # Основной игровой компонент
│   │   └── GameCanvas.tsx
│   └── UI/            # UI компоненты (меню, оверлеи)
│       ├── MainMenu.tsx
│       ├── PauseMenu.tsx
│       ├── GameOverMenu.tsx
│       └── PerformanceOverlay.tsx
├── contexts/          # React контексты для состояния
│   └── GameContext.tsx
├── game/              # Игровая логика
│   ├── entities/     # Игровые сущности
│   │   ├── Duck.ts
│   │   └── Obstacle.ts
│   ├── systems/      # Игровые системы
│   │   ├── CollisionSystem.ts
│   │   ├── ObstacleManager.ts
│   │   ├── ScoreSystem.ts
│   │   └── ParticleSystem.ts
│   └── utils/        # Утилиты
│       ├── constants.ts
│       ├── SoundManager.ts
│       ├── PerformanceMonitor.ts
│       └── BrowserCompatibility.ts
├── hooks/            # Кастомные React хуки
│   ├── useGameLoop.ts
│   └── useKeyboard.ts
├── types/            # TypeScript типы и интерфейсы
│   └── game.types.ts
└── assets/           # Ресурсы (звуки)
    └── sounds/
```

### Основные компоненты

- **GameCanvas** - основной компонент игры, управляет canvas и игровым циклом
- **GameContext** - глобальное состояние игры (счет, состояние, лучший результат)
- **Duck** - класс, представляющий игрового персонажа
- **Obstacle** - класс, представляющий препятствие
- **ObstacleManager** - система управления генерацией и обновлением препятствий
- **CollisionSystem** - система детекции коллизий
- **ScoreSystem** - система подсчета очков и расчета сложности
- **SoundManager** - менеджер звуковых эффектов
- **ParticleSystem** - система визуальных эффектов частиц

## Тестирование

Проект использует Vitest для unit-тестирования.

### Запуск тестов

Запустить все тесты:
```bash
npm test
```

Запустить тесты в watch режиме:
```bash
npm test
```

Запустить тесты один раз:
```bash
npm run test:run
```

Запустить тесты с UI:
```bash
npm run test:ui
```

### Покрытие тестами

Тесты покрывают:
- Игровые сущности (Duck, Obstacle)
- Системы (CollisionSystem, ObstacleManager, ScoreSystem)
- Контекст игры (GameContext)

## Дополнительные возможности

### Мониторинг производительности

Для включения overlay производительности (FPS, использование памяти):
```javascript
localStorage.setItem('duck-game-show-performance', 'true');
```

После перезагрузки страницы в правом верхнем углу появится overlay с метриками производительности.

### Проверка совместимости браузера

В режиме разработки автоматически проверяется совместимость браузера. Для включения проверки в production:
```javascript
localStorage.setItem('duck-game-show-compatibility', 'true');
```

## Разработка

### Скрипты

- `npm run dev` - запуск dev-сервера
- `npm run build` - сборка для production
- `npm run preview` - предпросмотр production сборки
- `npm run lint` - проверка кода линтером
- `npm run format` - форматирование кода с помощью Prettier
- `npm test` - запуск тестов

### Генерация звуков

В директории `src/assets/sounds/` находится скрипт `generate-sounds.js` для генерации звуковых эффектов. Звуки должны быть размещены в `public/sounds/`.

## Особенности реализации

- **Оптимизация производительности**: отрисовываются только видимые объекты, используется кэширование границ для коллизий
- **Адаптивность**: игра адаптируется к разным размерам экрана, включая мобильные устройства
- **Прогрессивная сложность**: скорость и расстояние между препятствиями изменяются в зависимости от счета
- **Система частиц**: визуальные эффекты при столкновении
- **Звуковые эффекты**: поддержка включения/выключения звуков
- **Сохранение прогресса**: лучший результат сохраняется в localStorage

## Лицензия

Этот проект создан в образовательных целях.
