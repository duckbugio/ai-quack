# Руководство по тестированию игры "Утка"

Это руководство описывает процесс тестирования игры на разных устройствах и браузерах.

## Содержание

1. [Тестирование на десктопе](#тестирование-на-десктопе)
2. [Тестирование на мобильных устройствах](#тестирование-на-мобильных-устройствах)
3. [Проверка производительности](#проверка-производительности)
4. [Инструменты для тестирования](#инструменты-для-тестирования)

---

## Тестирование на десктопе

### Chrome/Edge

1. **Запуск игры:**
   ```bash
   npm run dev
   ```

2. **Проверка работы игры:**
   - Откройте браузер и перейдите на `http://localhost:5173`
   - Проверьте, что игра загружается корректно
   - Проверьте работу клавиатуры (Пробел, Стрелка вверх)
   - Проверьте работу мыши (клик для прыжка)

3. **Проверка производительности:**
   - Откройте DevTools (F12)
   - Перейдите на вкладку "Performance"
   - Нажмите "Record" и играйте 10-15 секунд
   - Остановите запись и проверьте:
     - FPS должен быть стабильно около 60 FPS
     - Нет длительных блокировок основного потока
     - Время кадра не превышает 16.67ms

4. **Проверка памяти:**
   - Откройте DevTools (F12)
   - Перейдите на вкладку "Memory"
   - Сделайте снимок памяти перед началом игры
   - Играйте 1-2 минуты
   - Сделайте еще один снимок памяти
   - Проверьте, что использование памяти не растет постоянно (нет утечек)

5. **Включение мониторинга производительности:**
   - Откройте консоль (F12)
   - Выполните: `localStorage.setItem('duck-game-show-performance', 'true')`
   - Обновите страницу
   - В правом верхнем углу появится overlay с метриками производительности

### Firefox

1. **Проверка совместимости Canvas API:**
   - Игра должна работать так же, как в Chrome
   - Проверьте отрисовку всех элементов (фон, утка, препятствия)

2. **Проверка производительности:**
   - Откройте DevTools (F12)
   - Перейдите на вкладку "Performance"
   - Используйте инструмент профилирования для проверки FPS

3. **Примечание:**
   - Memory API недоступен в Firefox (только в Chrome)
   - Мониторинг памяти будет ограничен

### Safari (macOS)

1. **Проверка работы на macOS:**
   - Откройте Safari
   - Включите меню "Разработка" (если не включено):
     - Safari → Настройки → Дополнения → Включить меню "Разработка"
   - Проверьте работу игры

2. **Проверка производительности:**
   - Откройте Web Inspector (Cmd+Option+I)
   - Используйте инструменты профилирования

3. **Особенности Safari:**
   - Может быть более строгим к некоторым API
   - Проверьте работу звуков (может потребоваться взаимодействие пользователя)

### Проверка работы клавиатуры во всех браузерах

1. **Пробел:**
   - Должен вызывать прыжок утки
   - Должен работать во всех браузерах

2. **Стрелка вверх:**
   - Должна вызывать прыжок утки
   - Должна работать во всех браузерах

3. **Escape:**
   - Должна ставить игру на паузу
   - Должна возобновлять игру при повторном нажатии

---

## Тестирование на мобильных устройствах

### iOS Safari

1. **Подготовка:**
   - Убедитесь, что dev-сервер доступен в локальной сети
   - Найдите IP-адрес вашего компьютера:
     - macOS/Linux: `ifconfig` или `ip addr`
     - Windows: `ipconfig`
   - Запустите dev-сервер с доступом из сети:
     ```bash
     npm run dev -- --host
     ```

2. **Тестирование:**
   - Откройте Safari на iPhone/iPad
   - Перейдите на `http://YOUR_IP:5173`
   - Проверьте:
     - Touch события работают (тап для прыжка)
     - Игра адаптируется к размеру экрана
     - Производительность приемлема (нет лагов)

3. **Проверка ориентации:**
   - Поверните устройство в портретную ориентацию
   - Проверьте, что игра работает корректно
   - Поверните устройство в ландшафтную ориентацию
   - Проверьте, что игра адаптируется

### Android Chrome

1. **Тестирование:**
   - Откройте Chrome на Android устройстве
   - Перейдите на `http://YOUR_IP:5173`
   - Проверьте те же аспекты, что и для iOS

2. **Проверка разных размеров экрана:**
   - Протестируйте на разных устройствах:
     - Маленький экран (до 5 дюймов)
     - Средний экран (5-6 дюймов)
     - Большой экран (6+ дюймов)
   - Убедитесь, что игра масштабируется корректно

3. **Проверка производительности:**
   - Используйте Chrome DevTools для удаленной отладки:
     - Подключите устройство через USB
     - В Chrome на компьютере: `chrome://inspect`
     - Выберите устройство и откройте DevTools

### Проверка ориентации экрана

1. **Портретная ориентация:**
   - Игра должна масштабироваться для вертикального экрана
   - Все элементы должны быть видны
   - Управление должно работать

2. **Ландшафтная ориентация:**
   - Игра должна масштабироваться для горизонтального экрана
   - Canvas должен использовать доступное пространство эффективно

3. **Переключение ориентации:**
   - Поверните устройство во время игры
   - Игра должна адаптироваться без сбоев
   - Проверьте, что нет визуальных артефактов

### Убедиться, что игра работает без задержек

1. **Проверка отзывчивости:**
   - Тап должен вызывать прыжок мгновенно
   - Нет задержек между действием и реакцией

2. **Проверка плавности:**
   - Анимация должна быть плавной
   - Нет рывков или замираний

---

## Проверка производительности на слабых устройствах

### Использование Chrome DevTools Performance

1. **Профилирование:**
   - Откройте DevTools (F12)
   - Перейдите на вкладку "Performance"
   - Нажмите "Record"
   - Играйте 10-15 секунд
   - Остановите запись

2. **Анализ результатов:**
   - Проверьте FPS график:
     - Должен быть стабильно около 60 FPS
     - Не должно быть резких падений
   - Проверьте Main Thread:
     - Не должно быть длительных задач (> 50ms)
     - Игровой цикл должен выполняться быстро

3. **Использование CPU throttling:**
   - В DevTools Performance включите "CPU: 4x slowdown"
   - Это имитирует слабое устройство
   - Проверьте, что игра все еще играбельна

### Проверка FPS (должно быть стабильно 60 FPS)

1. **Включение FPS overlay:**
   ```javascript
   localStorage.setItem('duck-game-show-performance', 'true');
   ```
   - Обновите страницу
   - В правом верхнем углу появится overlay с FPS

2. **Проверка стабильности:**
   - Играйте 1-2 минуты
   - FPS должен оставаться около 60
   - Допустимы небольшие падения до 55-58 FPS
   - Падения ниже 50 FPS указывают на проблемы

### Проверка использования памяти (не должно расти)

1. **Мониторинг памяти:**
   - Откройте DevTools (F12)
   - Перейдите на вкладку "Memory"
   - Сделайте снимок памяти (Take heap snapshot)
   - Играйте 1-2 минуты
   - Сделайте еще один снимок памяти
   - Сравните размеры снимков

2. **Проверка на утечки:**
   - Используйте "Performance" профилирование с включенной опцией "Memory"
   - Играйте несколько минут
   - Проверьте график использования памяти
   - Память не должна постоянно расти

3. **Использование Performance Monitor:**
   - Включите overlay производительности
   - Следите за метрикой "Memory"
   - Память должна стабилизироваться после начальной загрузки

### Оптимизация проблемных участков при необходимости

1. **Идентификация проблем:**
   - Используйте Performance профилирование
   - Найдите функции, которые занимают много времени
   - Обратите внимание на:
     - Частые вызовы функций
     - Большие циклы
     - Сложные вычисления в каждом кадре

2. **Оптимизация:**
   - Кэшируйте результаты вычислений
   - Оптимизируйте отрисовку (рисуйте только видимые объекты)
   - Используйте requestAnimationFrame эффективно
   - Минимизируйте перерисовки

---

## Инструменты для тестирования

### Встроенные инструменты

1. **Performance Monitor:**
   - Включение: `localStorage.setItem('duck-game-show-performance', 'true')`
   - Показывает: FPS, время кадра, использование памяти

2. **Browser Compatibility Check:**
   - Автоматически выполняется в dev режиме
   - Показывает отчет в консоли
   - Включение в production: `localStorage.setItem('duck-game-show-compatibility', 'true')`

### Chrome DevTools

1. **Performance:**
   - Профилирование производительности
   - Анализ FPS
   - Анализ использования CPU

2. **Memory:**
   - Проверка утечек памяти
   - Анализ использования памяти

3. **Network:**
   - Проверка загрузки ресурсов
   - Анализ времени загрузки

### Firefox DevTools

1. **Performance:**
   - Профилирование производительности
   - Анализ FPS

2. **Memory:**
   - Проверка утечек памяти

### Safari Web Inspector

1. **Timeline:**
   - Профилирование производительности
   - Анализ FPS

2. **Memory:**
   - Проверка использования памяти

---

## Чеклист тестирования

### Десктоп

- [ ] Chrome/Edge - игра работает корректно
- [ ] Chrome/Edge - производительность 60 FPS
- [ ] Firefox - игра работает корректно
- [ ] Firefox - производительность приемлема
- [ ] Safari - игра работает корректно
- [ ] Safari - производительность приемлема
- [ ] Клавиатура работает во всех браузерах
- [ ] Мышь работает во всех браузерах
- [ ] Звуки работают во всех браузерах
- [ ] localStorage работает (сохранение лучшего результата)

### Мобильные устройства

- [ ] iOS Safari - touch события работают
- [ ] iOS Safari - производительность приемлема
- [ ] Android Chrome - touch события работают
- [ ] Android Chrome - производительность приемлема
- [ ] Портретная ориентация работает
- [ ] Ландшафтная ориентация работает
- [ ] Переключение ориентации не вызывает сбоев
- [ ] Игра адаптируется к разным размерам экрана
- [ ] Нет задержек при управлении

### Производительность

- [ ] FPS стабильно около 60 FPS
- [ ] Нет утечек памяти
- [ ] Время кадра не превышает 16.67ms
- [ ] Игра работает плавно на слабых устройствах (с CPU throttling)

---

## Отчет о тестировании

После тестирования рекомендуется создать отчет со следующей информацией:

1. **Информация о браузере:**
   - Название и версия браузера
   - Операционная система
   - Разрешение экрана

2. **Результаты тестирования:**
   - Работает ли игра корректно
   - Средний FPS
   - Использование памяти
   - Найденные проблемы

3. **Скриншоты:**
   - Скриншоты Performance профилирования
   - Скриншоты Memory снимков (если есть проблемы)

---

## Заключение

Это руководство должно помочь в комплексном тестировании игры на разных устройствах и браузерах. Регулярное тестирование помогает выявить проблемы на ранних этапах разработки и обеспечить хороший пользовательский опыт на всех платформах.
